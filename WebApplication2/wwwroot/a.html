<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script>
        var exports = {};
        var require = function (v) {
            return new exports[v];
        }
    </script>
    <script src="uuid.js" type="text/javascript"></script>
    <script src="JMSUploadFile.js" type="text/javascript"></script>
</head>
<body>
    <input id="file" multiple type="file" />
    <input id="file2" multiple type="file" />
    <button onclick="upload2()">
        upload
    </button>
    <div id="info"></div>
</body>
<script lang="ja">
    async function upload() {
        var token = "WyJ7XCJkXCI6XCI2NjY2NjZcIixcImVcIjoxNzMxODk3MDY4fSIsIjYyNzc0RjQ3MDEzRTAyQjQ1RjExN0Y1MjU4NDU4NUNGIl0=";

        var data1 = await document.querySelector("#file").files[0].arrayBuffer();
        var uploader = new JmsUploader("http://127.0.0.1:8911/UserInfoWebService/userinfo/test2", [data1, document.querySelector("#file2").files], { "Authorization": token }, {
            name: "abc"
        });
        uploader.onUploading = function (percent) {
            document.querySelector("#info").innerHTML = percent + "%";
        };

        var ret = await uploader.upload();
        alert(ret);
    }

    //npm安装组件： jms-uploader
    //import JmsUploader from "jms-uploader"
    async function upload2() {
        var token = "WyJ7XCJkXCI6XCI2NjY2NjZcIixcImVcIjoxNzMxODk3MDY4fSIsIjYyNzc0RjQ3MDEzRTAyQjQ1RjExN0Y1MjU4NDU4NUNGIl0=";
        var pics = [document.querySelector("#file").files ]; //上传的3个图片
        const model = {
            Name: 'asdfasdf',
            Country: "中国",
            IdNumber: 23452525235 //证件号码
        };

        var uploader = new JmsUploader(`http://8.222.158.1:11029/UserInfoWebService/userinfo/SubmitPassport`, pics, { "Authorization": token }, model);
        uploader.onUploading = function (percent) {
            //上传进度
            document.querySelector("#info").innerHTML = percent + "%";
        };

        try {
            var ret = await uploader.upload();
            alert(ret);
        } catch (e) {
            console.error(e);
        }

        //上传完毕
    }
</script>
</html>